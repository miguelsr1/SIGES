<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui">

    <h:panelGroup id="verblockInsumo"  layout="block">
        <div class="modal fade"  id="veranadirInsumo" tabindex="-1" role="dialog" aria-labelledby="veranadirInsumo">
            <div class="modal-dialog modal-lg" role="document">
                <h:panelGroup styleClass="modal-content" layout="block" id="vercontenidoModalInsumo">
                    <h:form id="veranadirInsumoForm"  prependId="false" > 
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="glyphicon glyphicon-remove-sign"></span></button>
                            <span class="modal-title">
                                <h:outputText value="#{textMB.obtenerTexto('labels.VerInsumo')}" /> 
                            </span>
                        </div>
                        <div class="modal-body">
                            <div class="form-horizontal">	

                                <h:panelGroup layout="block" >
                                    <ul class="nav nav-tabs">
                                        <li class="active"><a data-toggle="tab" href="#verTabInsumos">#{textMB.obtenerTexto('labels.Insumo')}</a></li>
                                        <ui:fragment rendered="#{parameterBean.tempInsumo.noUACI}">
                                            <li><a data-toggle="tab" href="#verTabFCM">#{textMB.obtenerTexto('labels.FlujoCajaMenusal')}</a></li>
                                        </ui:fragment>
                                    </ul>
                                </h:panelGroup>
                                <div class="tab-content">

                                    <!---  TABS DE  INSUMOS -->
                                    <h:outputText styleClass="requeridos" value="#{textMB.obtenerTexto('labels.PreciosExpresadosEnDolares')}"/>
                                    <h:panelGroup id="verTabInsumos" styleClass="tab-pane fade in active" layout="block"> 
                                        <div class="form-group">
                                            <h:outputLabel for="nombreInsumo" styleClass="col-sm-4 control-label" value="#{textMB.obtenerTexto('labels.Codigo')}:" />
                                            <div class="col-sm-8">
                                                <h:outputText  value="#{parameterBean.tempInsumo.id}" styleClass="form-control-static"    />
                                            </div>
                                        </div>       
                                        <div class="form-group">
                                            <h:outputLabel styleClass="col-sm-4 control-label" value="#{textMB.obtenerTexto('labels.Insumo')}:" />
                                            <div class="col-sm-8">
                                                <h:outputText  value="#{parameterBean.tempInsumo.insumo.nombre}" styleClass="form-control-static"    />
                                            </div>
                                        </div> 
                                        <div class="form-group">
                                            <h:outputLabel styleClass="col-sm-4 control-label" value="#{textMB.obtenerTexto('labels.UACI')}:" />
                                            <div class="col-sm-8">
                                                <h:outputText  rendered="#{parameterBean.tempInsumo.noUACI}" value="#{textMB.obtenerTexto('labels.No')}" styleClass="form-control-static"    />
                                                <h:outputText  rendered="#{not parameterBean.tempInsumo.noUACI}" value="#{textMB.obtenerTexto('labels.Si')}" styleClass="form-control-static"    />
                                            </div>
                                        </div> 
                                        <div class="form-group">
                                            <h:outputLabel styleClass="col-sm-4 control-label" value="#{textMB.obtenerTexto('labels.FechaEstimadaDeContratacion')}:" />
                                            <div class="col-sm-8">
                                                <h:outputText  value="#{parameterBean.tempInsumo.fechaContratacion}" styleClass="form-control-static" converter="dateConverter"/>
                                            </div>
                                        </div> 
                                        
                                        <h:panelGroup layout="block" rendered="#{parameterBean.tempInsumo.noUACI}">
                                            <div class="form-group">
                                                <p:outputLabel styleClass="col-sm-4 control-label" value="#{textMB.obtenerTexto('labels.FechaRealInicioEjecucion')}:"/>
                                                <div class="col-sm-8">
                                                    <h:outputText  value="#{parameterBean.tempInsumo.fechaRealInicioEjecucion}" styleClass="form-control-static" converter="dateConverter"/>                                                    
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <h:outputLabel styleClass="col-sm-4 control-label" value="#{textMB.obtenerTexto('labels.DuracionInsumo')}:" />
                                                <div class="col-sm-8">
                                                    <h:outputText  value="#{parameterBean.tempInsumo.duracion}" styleClass="form-control-static numericos"/>
                                                </div>
                                            </div>
                                        </h:panelGroup>

                                        <div class="form-group">
                                            <h:outputLabel styleClass="col-sm-4 control-label" value="#{textMB.obtenerTexto('labels.Observacion')}:" />
                                            <div class="col-sm-8">
                                                <h:outputText  value="#{parameterBean.tempInsumo.observacion}" styleClass="form-control-static"/>
                                            </div>
                                        </div> 

                                        <div class="form-group">
                                            <h:outputLabel styleClass="col-sm-4 control-label" value="#{textMB.obtenerTexto('labels.Cantidad')}:" />
                                            <div class="col-sm-1">
                                                <h:outputText  value="#{parameterBean.tempInsumo.cantidad}" styleClass="form-control-static numericos"/>
                                            </div>
                                        </div> 
                                        
                                        <div class="form-group">
                                            <h:outputLabel styleClass="col-sm-4 control-label" value="#{textMB.obtenerTexto('labels.MontoUnitario')}:" />
                                            <div class="col-sm-1">
                                                <h:outputText  value="#{parameterBean.tempInsumo.montoUnit}" styleClass="form-control-static numericos">
                                                    <f:convertNumber locale="#{utilsMB.localeDinero}" pattern="#{utilsMB.patternDinero}"/>
                                                </h:outputText>
                                            </div>
                                        </div> 
                                        
                                        <div class="form-group">
                                            <h:outputLabel styleClass="col-sm-4 control-label" value="#{textMB.obtenerTexto('labels.MontoTotal')}:" />
                                            <div class="col-sm-1">
                                                <h:outputText  value="#{parameterBean.tempInsumo.montoTotal}" styleClass="form-control-static numericos">
                                                    <f:convertNumber locale="#{utilsMB.localeDinero}" pattern="#{utilsMB.patternDinero}"/>
                                                </h:outputText>
                                            </div>
                                        </div> 

                                        <p:outputPanel>
                                            <ui:fragment rendered="#{ parameterBean.getTipoPO() eq 'TIPO_PO_PROYECTO' or parameterBean.getTipoPO() eq 'TIPO_POG_PROYECTO' }">  
                                            
                                                <p:outputPanel >
                                                    <fieldset class="fieldset fieldsetSmall margenSup">
                                                        
                                                        <legend><h:outputText  value="#{textMB.obtenerTexto('labels.MontosFuentes')}" /></legend>
                                                        <h:dataTable styleClass="table-padding" value="#{parameterBean.ordenarMontosFuentes(parameterBean.tempInsumo.montosFuentes)}" var="monto">
                                                            <h:column>
                                                                <h:outputLabel  styleClass="control-label">
                                                                    <h:outputText  value="*#{monto.fuente.fuenteRecursos.nombre}, " />
                                                                    <h:outputText value="#{monto.fuente.categoriaConvenio.nombre}:" />
                                                                </h:outputLabel>
                                                            </h:column>                                                            
                                                            <h:column>
                                                                <h:panelGroup  styleClass="input-group " layout="block">
                                                                    <h:outputText  value="#{monto.monto}"  styleClass="form-control-static numericos">
                                                                        <f:convertNumber locale="#{utilsMB.localeDinero}" pattern="#{utilsMB.patternDinero}"/>
                                                                    </h:outputText>	
                                                                </h:panelGroup> 
                                                            </h:column>
                                                        </h:dataTable>
                                                    </fieldset>
                                                </p:outputPanel>
                                            </ui:fragment>
                                        </p:outputPanel>
                                    </h:panelGroup>
                                    <!---  TABS DE  FCM -->
                                    <h:panelGroup id="verTabFCM" styleClass="tab-pane fade" layout="block"> 
                                        <ui:fragment rendered="#{parameterBean.tempInsumo.noUACI}">
                                            <h:panelGroup layout="block" id="verFlujoCajaMenusal">
                                                <h:panelGroup layout="block">
                                                    <fieldset class="fieldset fieldsetSmall margenSup margenInf">
                                                        <legend><h:outputText  value="#{textMB.obtenerTexto('labels.FlujoCajaMensual')}" /></legend>

                                                        <div class="form-group">
                                                            <h:outputLabel for="mes-flujo"  styleClass="col-sm-3 control-label" value="#{textMB.obtenerTexto('labels.Meses')}" />
                                                            <div class="col-sm-9">
                                                                <h:outputText value="#{textMB.obtenerTexto('labels.TotalInsumoMes')}" styleClass="textoMedio"  />
                                                                <ui:repeat  var="fuenteFCM" value="#{parameterBean.ordenarMontosFuentes(parameterBean.tempInsumo.montosFuentes)}" varStatus="status"
                                                                            rendered="#{parameterBean.cantidadMontosFuentesDePoInsumo ne 1 }">
                                                                    <h:outputText value="#{fuenteFCM.fuente.fuenteRecursos.codigo}" styleClass="textoMedio"  />                                                             
                                                                </ui:repeat>
                                                            </div>
                                                        </div>

                                                        <ui:repeat  var="anioFlujo" value="#{parameterBean.tempInsumo.flujosDeCajaAnio.toArray()}">
                                                            <ui:repeat  var="flujo" value="#{anioFlujo.flujoCajaMenusal}" varStatus="status">
                                                                <div class="form-group">
                                                                    <h:outputLabel for="mes-flujo"  styleClass="col-sm-3 control-label" value="#{parameterBean.getMesName(flujo.mes-1)}:" />
                                                                    <div class="col-sm-9">
                                                                        <h:inputText  value="#{flujo.monto}" styleClass="form-control textoMedio numericos"  disabled="true">
                                                                            <f:convertNumber locale="#{utilsMB.localeDinero}" pattern="#{utilsMB.patternDinero}"/>
                                                                        </h:inputText>
                                                                        <ui:repeat var="fuenteFCM" value="#{parameterBean.ordenarMontosFuentesFCM(flujo.montosFuentesInsumosFCM)}"
                                                                                    rendered="#{parameterBean.cantidadMontosFuentesDePoInsumo ne 1 }">
                                                                            <h:inputText  value="#{fuenteFCM.monto}" styleClass="form-control textoMedio numericos" disabled="true">
                                                                                <f:convertNumber locale="#{utilsMB.localeDinero}" pattern="#{utilsMB.patternDinero}"/>
                                                                            </h:inputText>
                                                                        </ui:repeat>
                                                                    </div>                                                                   
                                                                </div>
                                                            </ui:repeat>                                                            
                                                        </ui:repeat>

                                                        <h:panelGroup  class="form-group" layout="block">
                                                            <h:outputLabel styleClass="col-sm-3 control-label" value="#{textMB.obtenerTexto('labels.Totales')}:" />
                                                            <div class="col-sm-9">
                                                                <h:outputText value="#{parameterBean.tempInsumo.totalProgramacionFinanciera}" styleClass="textoMedio numericos" >
                                                                    <f:convertNumber locale="#{utilsMB.localeDinero}" pattern="#{utilsMB.patternDinero}"/>
                                                                </h:outputText>
                                                                <ui:repeat  var="montoFuente" value="#{parameterBean.ordenarMontosFuentes(parameterBean.tempInsumo.montosFuentes)}" varStatus="status"
                                                                            rendered="#{parameterBean.cantidadMontosFuentesDePoInsumo ne 1 }">
                                                                    <h:outputText value="#{montoFuente.totalProgramacionFinanciera}" styleClass="textoMedio numericos"  >
                                                                        <f:convertNumber locale="#{utilsMB.localeDinero}" pattern="#{utilsMB.patternDinero}"/>
                                                                    </h:outputText>                                                             
                                                                </ui:repeat>
                                                            </div>
                                                        </h:panelGroup>

                                                    </fieldset>
                                                </h:panelGroup>
                                            </h:panelGroup>
                                        </ui:fragment>
                                    </h:panelGroup>
                                </div>
                            </div>
                        </div>

                        <div class="modal-footer">
                            <!--<p:commandButton  styleClass="btn btn-primary" icon="glyphicon glyphicon-ok" value="#{textMB.obtenerTexto('labels.Aceptar')}" actionListener="#{parameterBean.guardarInsumo()}" update="tablaLineas contenidoModalInsumo"/>-->
                            <p:commandButton  styleClass="btn btn-link"  value="#{textMB.obtenerTexto('labels.Cancelar')}" actionListener="#{parameterBean.reloadPO()}" update="tablaLineas" oncomplete="$('#veranadirInsumo').modal('hide');"  />
                        </div>
                    </h:form> 
                </h:panelGroup>
            </div>
        </div> 
    </h:panelGroup>
</ui:composition>
